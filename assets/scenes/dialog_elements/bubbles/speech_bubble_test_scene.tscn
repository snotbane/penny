[gd_scene load_steps=9 format=3 uid="uid://dk0glj02jng6r"]

[ext_resource type="PackedScene" uid="uid://b8w7wdy7jy5vo" path="res://addons/penny_godot/assets/scenes/dialog_elements/bubbles/dialog_bubble_tail_shaped.tscn" id="1_4inls"]
[ext_resource type="Script" uid="uid://bb13j6jb7ri83" path="res://addons/penny_godot/assets/scripts/geometry/superellipse_3d.gd" id="1_uq4v2"]
[ext_resource type="Script" uid="uid://by10d1c5kuqkp" path="res://addons/penny_godot/assets/scripts/geometry/superellipse_2d.gd" id="2_vfnae"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_4inls"]
sky_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)
ground_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)

[sub_resource type="Sky" id="Sky_vfnae"]
sky_material = SubResource("ProceduralSkyMaterial_4inls")

[sub_resource type="Environment" id="Environment_uq4v2"]
background_mode = 2
sky = SubResource("Sky_vfnae")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="GDScript" id="GDScript_4inls"]
script/source = "extends Node3D

func _process(delta: float) -> void:
	self.global_position = self.get_viewport().get_camera_3d().project_position(mouse_position, remap(sin(Time.get_ticks_msec() / 1000.0), -1, 1, 1, 3))

var mouse_position : Vector2
func _input(event: InputEvent) -> void:
	if event is InputEventMouseMotion:
		mouse_position = event.position
"

[sub_resource type="SphereMesh" id="SphereMesh_4inls"]

[node name="speech_bubble_test_scene" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_uq4v2")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, 0.75, -0.433013, 0, 0, 0)
shadow_enabled = true

[node name="superellipse3d" type="Node3D" parent="."]

[node name="csg_polygon_3d" type="CSGPolygon3D" parent="superellipse3d"]
polygon = PackedVector2Array(1.5, 0, 1.49725, 0.118203, 1.48896, 0.190234, 1.47493, 0.249791, 1.45485, 0.301099, 1.42819, 0.345705, 1.39415, 0.384297, 1.35151, 0.417201, 1.29827, 0.444566, 1.23099, 0.466452, 1.14296, 0.482876, 1.01798, 0.493833, 0.790362, 0.499315, -0.790362, 0.499315, -1.01798, 0.493833, -1.14296, 0.482876, -1.23099, 0.466452, -1.29827, 0.444566, -1.35151, 0.417201, -1.39415, 0.384297, -1.42819, 0.345705, -1.45485, 0.301099, -1.47493, 0.249791, -1.48896, 0.190234, -1.49725, 0.118203, -1.5, 4.45633e-12, -1.49725, -0.118203, -1.48896, -0.190234, -1.47493, -0.249791, -1.45485, -0.301099, -1.42819, -0.345705, -1.39415, -0.384297, -1.35151, -0.417201, -1.29827, -0.444566, -1.23099, -0.466452, -1.14296, -0.482876, -1.01798, -0.493833, -0.790362, -0.499315, 0.790362, -0.499315, 1.01798, -0.493833, 1.14296, -0.482876, 1.23099, -0.466452, 1.29827, -0.444566, 1.35151, -0.417201, 1.39415, -0.384297, 1.42819, -0.345705, 1.45485, -0.301099, 1.47493, -0.249791, 1.48896, -0.190234, 1.49725, -0.118203)
depth = 0.01
smooth_faces = true
script = ExtResource("1_uq4v2")
resolution = 5000
size = Vector2(3, 1)
super_power = 1.2
proportional = true

[node name="tail_target" type="Node3D" parent="."]
script = SubResource("GDScript_4inls")

[node name="mesh_instance_3d" type="MeshInstance3D" parent="tail_target"]
visible = false
mesh = SubResource("SphereMesh_4inls")
skeleton = NodePath("../../camera_3d")

[node name="canvas_layer" type="CanvasLayer" parent="."]

[node name="control" type="Control" parent="canvas_layer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="bubble" type="CenterContainer" parent="canvas_layer/control"]
custom_minimum_size = Vector2(0, 400)
layout_mode = 1
anchors_preset = 12
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_top = -400.0
grow_horizontal = 2
grow_vertical = 0

[node name="control" type="Control" parent="canvas_layer/control/bubble"]
layout_mode = 2

[node name="body" type="Node2D" parent="canvas_layer/control/bubble/control"]

[node name="superellipse" type="Node2D" parent="canvas_layer/control/bubble/control/body"]
script = ExtResource("2_vfnae")
resolution = 50
size = Vector2(1750, 370)
super_power = 1.2
proportional = true
metadata/_custom_type_script = "uid://by10d1c5kuqkp"

[node name="dialog_bubble_tail_jagged" parent="canvas_layer/control/bubble/control" node_paths=PackedStringArray("world_target") instance=ExtResource("1_4inls")]
world_target = NodePath("../../../../../tail_target")
profile_scale = Vector2(3, 1)
head_tangent_scale = Vector2(0, 0.333)
head_position_scale = Vector2(0.167, 0)
damping = 0.97

[node name="camera_3d" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 2)
current = true
